<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Loja — Meu Livro</title>
  <meta name="theme-color" content="#111827" />
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="styles-darkside.css" />
  <link rel="stylesheet" href="shop.css" />
</head>
<body>
  <div class="cloud" aria-hidden="true">
    <img src="imagens/clouds.png" alt="" class="img_cloud">
  </div>

  <header class="site-header">
    <div class="container nav-wrap">
      <a class="brand" href="index.html" aria-label="Página inicial">
        <img src="assets/favicon.svg" alt="" class="brand-mark" />
        <span class="brand-name">Meu Livro</span>
      </a>
      <button class="nav-toggle" aria-expanded="false" aria-controls="primary-nav" aria-label="Abrir menu">☰</button>
      <nav id="primary-nav" class="nav">
        <a href="index.html" class="nav-link">Início</a>
        <a href="autor.html" class="nav-link">Sobre o Autor</a>
        <a href="loja.html" class="nav-link active">Loja</a>
        <a href="comprar.html" class="nav-link cta">Comprar</a>
      </nav>
    </div>
  </header>

  <main class="container shop">
    <header class="shop-head">
      <h1>Loja</h1>
      <p class="muted">Explore os produtos disponíveis.</p>
    </header>

    <section class="shop-toolbar">
      <div class="search">
        <input id="q" type="search" placeholder="Buscar por título ou categoria…" aria-label="Buscar produtos" />
      </div>
    </section>

    <section class="shop-list">
      <div class="shop-list-head">
        <h2>Produtos</h2>
        <span id="count" class="muted">0 itens</span>
      </div>
      <div id="productsGrid" class="products-grid"></div>
      <p id="emptyState" class="muted empty-state" hidden>Nenhum produto por aqui ainda.</p>
      <p class="small muted">Para cadastrar ou editar produtos, acesse a página de administração.</p>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© <span id="year"></span> Meu Livro — Todos os direitos reservados.</p>
    </div>
  </footer>

  <script>
  (function(){
    const $ = (s, r=document)=>r.querySelector(s);
    const fmtBRL = v => new Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL'}).format(v);
    const KEY='produtosLoja';
    const cover='assets/cover-placeholder.svg';
    const q = $('#q'), grid=$('#productsGrid'), count=$('#count'), empty=$('#emptyState');

    function load(){
      try { return JSON.parse(localStorage.getItem(KEY)) || []; }
      catch { return []; }
    }

    function render(){
      const data = load();
      const term = (q.value||'').trim().toLowerCase();
      const list = term ? data.filter(p =>
        (p.title||'').toLowerCase().includes(term) ||
        (p.category||'').toLowerCase().includes(term)
      ) : data;

      count.textContent = `${list.length} ${list.length===1?'item':'itens'}`;
      empty.hidden = list.length !== 0;

      grid.innerHTML = list.map(p=>`
        <article class="product-card">
          <div class="product-img"><img src="${p.image||cover}" alt="${p.title}"></div>
          <div class="product-body">
            <h3 class="product-title">${p.title}</h3>
            <p class="product-desc">${p.desc||''}</p>
            <div class="product-meta">
              <span class="badge">${p.category||'Produto'}</span>
              <span class="price">${fmtBRL(Number(p.price||0))}</span>
            </div>
          </div>
        </article>
      `).join('');
    }

    q.addEventListener('input', render);
    render();
    const yr=document.getElementById('year'); if(yr) yr.textContent=new Date().getFullYear();
  })();
  </script>
</body>
</html>
