<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Comprar — Meu Livro</title>
  <meta name="theme-color" content="#111827" />
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="styles-darkside.css" />
</head>
<body>
  <!-- Fundo: nuvem animada -->
  <div class="cloud" aria-hidden="true">
    <img src="imagens/clouds.png" alt="" class="img_cloud">
  </div>

  <header class="site-header">
    <div class="container nav-wrap">
      <!-- “Meu Livro” abre o menu também aqui -->
      <button class="nav-toggle" aria-expanded="false" aria-controls="primary-nav" aria-label="Abrir menu">☰</button>
      <nav id="primary-nav" class="nav">
        <a href="index.html" class="nav-link">Início</a>
        <a href="autor.html" class="nav-link">Sobre o Autor</a>
        <a href="comprar.html" class="nav-link cta">Comprar</a>
      </nav>
    </div>
  </header>

  <main class="container buy">
    <header class="shop-head">
      <h1>Finalizar compra</h1>
      <p class="muted">Escolha o formato, informe a quantidade e seu nome. Você será direcionado ao WhatsApp para concluir o pedido.</p>
    </header>

    <section class="product-form" aria-labelledby="buyFormTitle">
      <h2 id="buyFormTitle">Detalhes do pedido</h2>

      <form id="buyForm">
        <div class="grid-2">
          <label class="field">
            <span>Formato*</span>
            <select id="formato" required>
              <option value="">Selecione</option>
              <option>Físico (Brochura)</option>
              <option>eBook (PDF/ePub)</option>
            </select>
          </label>

          <label class="field">
            <span>Quantidade*</span>
            <input id="quantidade" type="number" min="1" step="1" value="1" required>
          </label>
        </div>

        <label class="field">
          <span>Seu nome*</span>
          <input id="nome" type="text" placeholder="Como devemos te chamar?" required>
        </label>

        <label class="field">
          <span>Observações (opcional)</span>
          <textarea id="obs" rows="3" placeholder="Ex.: Autografar para Fulano, enviar presente, etc."></textarea>
        </label>

        <div class="form-actions">
          <button type="submit" class="btn primary">Enviar pelo WhatsApp</button>
          <a href="index.html" class="btn ghost">Voltar</a>
        </div>
      </form>
    </section>

    <aside class="card note">
      <p class="small muted">
        Não processamos pagamentos no site. Você confirmará o pedido e combinará pagamento/entrega diretamente pelo WhatsApp.
      </p>
    </aside>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© <span id="year"></span> Meu Livro — Todos os direitos reservados.</p>
    </div>
  </footer>

  <script>
    // Menu acionado pelo “Meu Livro”
    (function(){
      const trigger  = document.getElementById('menuTriggerBrand');
      const panel    = document.getElementById('menuPanel');
      const list     = panel ? panel.querySelector('.menu-list') : null;
      const backdrop = document.getElementById('menuBackdrop');
      const headerNav= document.getElementById('primary-nav');
      if (!trigger || !panel || !list || !headerNav) return;
      const links = Array.from(headerNav.querySelectorAll('a.nav-link, a.nav-link.cta'));
      list.innerHTML = links.map(a => `<a class="${a.className}" href="${a.getAttribute('href')}">${a.textContent.trim()}</a>`).join('');
      function openMenu(){ panel.hidden=false; backdrop.hidden=false; trigger.setAttribute('aria-expanded','true'); document.addEventListener('keydown', onKey); }
      function closeMenu(){ panel.hidden=true;  backdrop.hidden=true;  trigger.setAttribute('aria-expanded','false'); document.removeEventListener('keydown', onKey); }
      function onKey(e){ if (e.key==='Escape') closeMenu(); }
      trigger.addEventListener('click', e => { e.preventDefault(); panel.hidden ? openMenu() : closeMenu(); });
      trigger.addEventListener('keydown', e => { if (e.key==='Enter'||e.key===' ') { e.preventDefault(); openMenu(); }});
      backdrop && backdrop.addEventListener('click', closeMenu);
      document.addEventListener('click', e => { if (panel.hidden) return; const inside = panel.contains(e.target) || trigger.contains(e.target); if (!inside) closeMenu(); });
    })();

    // WhatsApp redirect (sem pagamento no site)
    (function(){
      const form = document.getElementById('buyForm');
      const phone = '5599999999999'; // <<< TROQUE PELO SEU NÚMERO COM DDI+DDD (ex.: 55 11 91234-5678 => 5511912345678)

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const formato = document.getElementById('formato').value.trim();
        const quantidade = parseInt(document.getElementById('quantidade').value, 10) || 1;
        const nome = document.getElementById('nome').value.trim();
        const obs = document.getElementById('obs').value.trim();

        if (!formato || !nome) {
          alert('Preencha “Formato” e “Seu nome”.');
          return;
        }

        const msg = [
          'Olá! Quero comprar "Meu Livro".',
          `Formato: ${formato}`,
          `Quantidade: ${quantidade}`,
          `Nome: ${nome}`,
          obs ? `Observações: ${obs}` : null,
          '',
          'Podemos seguir com pagamento e envio?'
        ].filter(Boolean).join('\n');

        const url = `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
        window.open(url, '_blank'); // abre o WhatsApp
      });

      const yr=document.getElementById('year'); if(yr) yr.textContent=new Date().getFullYear();
    })();
  </script>
</body>
</html>
